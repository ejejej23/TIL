#서브쿼리 조인

### 서브쿼리 조인이 필요한 이유
: 최근 옵티마이저는 비용cost를 평가하고 실행계힉을 생성하기 앞서 사용자로부터 전달받은 sql을 최적화에 유리한 형태로 변환하는 작업, 즉 쿼리변환부터 수행한다.

쿼리변환Query Transformation : 옵티마이저가 sql을 분석해 의미적으로 동일하면서도 더 나은 성능의 형태로 재작성하는것

서브쿼리 : 하나의 sql문 안에 괄호로 묶은 별도의 쿼리블록

-------

### 인라인뷰Inline view 
: from 절에 사용한 서브쿼리
### 중첩된 서브쿼리Nested Subquery 
: where 절에 사용한 서브쿼리. 특히 서브쿼리가 메인쿼리 컬럼을 참조하는 형태를 '상관관계있는 서브쿼리Correlated' 라고함
### 스칼라 서브쿼리Scalar Subquery
: 한 레코드당 정확히 하나의 값을 반환하는 서브쿼리

- 옵티마이저는 쿼리블록 단위로 최적화를 수행

-----

## 필터 오퍼레이션
: no_unnest 힌트 사용. 기본적으로 nl 조인과 처리 루틴이 같다. 
차이점은 아래와 같다
- 필터는 메인쿼리의 한 로우가 서브쿼리의 한 로우와 조인에 성공하는 순간 진행을 멈추고, 메인쿼리의 다음 로우를 계속 처리한다
- 필터는 캐싱기능이 있다
- 필터 서브쿼리는 일반 nl조인과 달리 메인쿼리에 종속되므로 조인순서가 고정된다. 메인쿼리가 항상 드라이빙 집합이다.

## 서브쿼리 Unnesting
: 옵티마이저가 대개 Unnesting 을 선택한다. 서브쿼리를 풀어낸다는 뜻.
- 서브쿼리를 그대로 두면 필터방식을 사용할수밖에 없지만, Unnesting하면 일반 조인문처럼 다양한 최적화 기법을 사용할 수 있다.

cf)nl 세미조인
: 기본적으로 nl 조인과 같은 프로세스. 다른점은 조인에 성공하는 순간 진행을 멈추고 메인쿼리의 다음 로우를 처리한다는 점.
오라클 10g부터는 nl세미조인이 캐싱기능도 갖게 되었으므로 사실상 필터 오퍼레이션과 큰 차이는 없다.

-----

